<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SENTINEL PRO - Sistema de Mantenimiento Predictivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- HEADER -->
    <header>
        <h1>
            <i class="fas fa-shield-halved"></i>
            SENTINEL PRO
        </h1>
        <p>Sistema Inteligente de Mantenimiento Predictivo Vehicular</p>
    </header>

    <!-- NAVBAR DE NAVEGACIÓN -->
    <nav class="main-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-link">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a>
            <a href="fleet.html" class="nav-link">
                <i class="fas fa-cars"></i> Flotas
            </a>
            <a href="analytics.html" class="nav-link">
                <i class="fas fa-chart-line"></i> Analytics
            </a>
            <a href="vehicle-detail.html" class="nav-link" id="nav-vehicle-detail" style="display: none;">
                <i class="fas fa-car-side"></i> Vehículo
            </a>
            <a href="alerts.html" class="nav-link">
                <i class="fas fa-bell"></i> Alertas
            </a>
            <a href="import.html" class="nav-link" id="nav-import" style="display: none;">
                <i class="fas fa-file-import"></i> Importar CSV
            </a>
        </div>
    </nav>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container">
        
        <!-- SECCIÓN 1: CONFIGURACIÓN DEL VEHÍCULO -->
        <div class="card">
            <h2>
                <i class="fas fa-cog"></i>
                Configuración del Vehículo
            </h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="vehicleBrand"><i class="fas fa-car"></i> Marca</label>
                    <input type="text" id="vehicleBrand" placeholder="Ej: Seat">
                </div>
                <div class="form-group">
                    <label for="vehicleModel"><i class="fas fa-cogs"></i> Modelo y Motor</label>
                    <input type="text" id="vehicleModel" placeholder="Ej: León 2.0 TDI">
                </div>
                <div class="form-group">
                    <label for="vehicleYear"><i class="fas fa-calendar"></i> Año</label>
                    <input type="number" id="vehicleYear" placeholder="Ej: 2018" min="1996">
                </div>
                <div class="form-group">
                    <label for="vehicleMileage"><i class="fas fa-road"></i> Kilómetros</label>
                    <input type="number" id="vehicleMileage" placeholder="Ej: 95000">
                </div>
                <div class="form-group">
                    <label for="vehicleTransmission"><i class="fas fa-gears"></i> Transmisión</label>
                    <select id="vehicleTransmission">
                        <option value="manual">Manual</option>
                        <option value="automatica">Automática</option>
                        <option value="dsg">DSG/DCT</option>
                        <option value="cvt">CVT</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="vehicleType"><i class="fas fa-droplet"></i> Combustible</label>
                    <select id="vehicleType">
                        <option value="gasolina">Gasolina</option>
                        <option value="diesel">Diésel</option>
                        <option value="hibrido">Híbrido</option>
                        <option value="electrico">Eléctrico</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- SECCIÓN 2: SALUD DEL VEHÍCULO -->
        <div class="card health-card-main">
            <h2>
                <i class="fas fa-heartbeat"></i>
                Salud del Vehículo en Tiempo Real
            </h2>
            <div class="health-score-container">
                <div class="health-score-circle">
                    <span id="health_score" class="health-score-value excellent">100</span>
                    <span class="health-score-label">/100</span>
                </div>
                <div class="health-details-grid">
                    <div class="health-detail-item">
                        <i class="fas fa-engine"></i>
                        <span class="detail-label">Motor</span>
                        <span id="engine_health" class="detail-value">100</span>
                    </div>
                    <div class="health-detail-item">
                        <i class="fas fa-temperature-high"></i>
                        <span class="detail-label">Térmica</span>
                        <span id="thermal_health" class="detail-value">100</span>
                    </div>
                    <div class="health-detail-item">
                        <i class="fas fa-leaf"></i>
                        <span class="detail-label">Eficiencia</span>
                        <span id="efficiency_health" class="detail-value">100</span>
                    </div>
                </div>
            </div>
            
            <div id="warnings_container" class="warnings-container" style="display: none;"></div>
            <div id="predictions_container" class="predictions-container" style="display: none;"></div>
        </div>

        <!-- SECCIÓN 3: DATOS EN VIVO OPTIMIZADOS -->
        <div class="card">
            <h2>
                <i class="fas fa-tachometer-alt"></i>
                Datos en Vivo del Vehículo
                <span class="optimization-badge"><i class="fas fa-bolt"></i> Optimizado</span>
            </h2>
            
            <div class="data-section-header">
                <h3><i class="fas fa-stopwatch"></i> Datos Críticos (cada 3 segundos)</h3>
            </div>
            <div class="grid-stats">
                <div class="metric-box">
                    <div class="metric-label">
                        <i class="fas fa-cogs"></i> RPM Motor
                    </div>
                    <span class="metric-value" id="live_rpm">---</span>
                    <span class="metric-unit">rpm</span>
                </div>
                <div class="metric-box">
                    <div class="metric-label">
                        <i class="fas fa-road"></i> Velocidad
                    </div>
                    <span class="metric-value" id="live_speed">---</span>
                    <span class="metric-unit">km/h</span>
                </div>
                <div class="metric-box">
                    <div class="metric-label">
                        <i class="fas fa-route"></i> Distancia
                    </div>
                    <span class="metric-value" id="live_distance">---</span>
                    <span class="metric-unit">km</span>
                </div>
                <div class="metric-box">
                    <div class="metric-label">
                        <i class="fas fa-gas-pump"></i> Acelerador
                    </div>
                    <span class="metric-value" id="live_throttle">---</span>
                    <span class="metric-unit">%</span>
                </div>
                <div class="metric-box">
                    <div class="metric-label">
                        <i class="fas fa-weight-hanging"></i> Carga Motor
                    </div>
                    <span class="metric-value" id="live_load">---</span>
                    <span class="metric-unit">%</span>
                </div>
                <div class="metric-box">
                    <div class="metric-label">
                        <i class="fas fa-wind"></i> Flujo Aire (MAF)
                    </div>
                    <span class="metric-value" id="live_maf">---</span>
                    <span class="metric-unit">g/s</span>
                </div>
            </div>

            <div class="data-section-header thermal-section">
                <h3><i class="fas fa-clock"></i> Datos Térmicos (cada 60 segundos)</h3>
            </div>
            <div class="grid-stats thermal-grid">
                <div class="metric-box thermal">
                    <div class="metric-label">
                        <i class="fas fa-temperature-high"></i> Temp. Refrigerante
                    </div>
                    <span class="metric-value" id="live_coolant_temp">---</span>
                    <span class="metric-unit">°C</span>
                </div>
                <div class="metric-box thermal">
                    <div class="metric-label">
                        <i class="fas fa-temperature-low"></i> Temp. Admisión
                    </div>
                    <span class="metric-value" id="live_intake_temp">---</span>
                    <span class="metric-unit">°C</span>
                </div>
            </div>

            <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
                <button id="analyzeTripBtn" class="btn btn-primary">
                    <i class="fas fa-brain"></i>
                    Análisis Predictivo con IA
                </button>
                <button id="downloadReportBtn" class="btn btn-primary">
                    <i class="fas fa-file-pdf"></i>
                    Descargar Informe
                </button>
                <button id="downloadCSVBtn" class="btn btn-primary">
                    <i class="fas fa-file-csv"></i>
                    Descargar CSV
                </button>
            </div>
        </div>

        <!-- SECCIÓN 4: RESULTADOS DEL ANÁLISIS PREDICTIVO -->
        <div id="ai-placeholder" class="card" style="text-align: center; padding: 3rem;">
            <i class="fas fa-brain" style="font-size: 3rem; color: #cbd5e1; margin-bottom: 1rem; display: block;"></i>
            <h3 style="color: #94a3b8; margin: 0;">Inicia un viaje para ver el análisis predictivo de SENTINEL PRO</h3>
            <p style="color: #cbd5e1; margin-top: 0.5rem;">El sistema analizará automáticamente tu conducción y predecirá necesidades de mantenimiento</p>
        </div>

        <div id="ai-results" style="display: none;"></div>

        <!-- SECCIÓN 5: MÓDULOS DE INTELIGENCIA -->
        <div class="grid-2">
            <div class="card">
                <h2>
                    <i class="fas fa-search"></i>
                    Análisis de Averías
                </h2>
                <p>Descubre las averías más comunes reportadas para tu modelo específico y cómo prevenirlas.</p>
                <button id="commonFailuresBtn" class="btn btn-primary" style="margin-top: 1rem;">
                    <i class="fas fa-stethoscope"></i>
                    Analizar Averías
                </button>
                <div id="common-failures-result" style="margin-top: 1rem;"></div>
            </div>

            <div class="card">
                <h2>
                    <i class="fas fa-euro-sign"></i>
                    Tasación Inteligente
                </h2>
                <p>Obtén una valoración de mercado ajustada por el trato y mantenimiento que ha recibido tu vehículo.</p>
                <button id="valuationBtn" class="btn btn-primary" style="margin-top: 1rem;">
                    <i class="fas fa-calculator"></i>
                    Calcular Valor
                </button>
                <div id="valuation-result" style="margin-top: 1rem;"></div>
            </div>
        </div>

        <!-- SECCIÓN 6: GESTIÓN DE ARCHIVOS CSV -->
        <div class="card">
            <h2>
                <i class="fas fa-database"></i>
                Gestión de Archivos CSV
            </h2>
            <p>Sube archivos CSV de viajes previos para análisis histórico y comparativo.</p>
            
            <div style="margin: 1.5rem 0;">
                <input type="file" id="uploadCSVInput" accept=".csv" style="display: none;">
                <button id="uploadCSVBtn" class="btn btn-primary">
                    <i class="fas fa-file-upload"></i>
                    Subir Archivo CSV
                </button>
            </div>

            <div id="csvFilesList" style="margin: 1.5rem 0;">
                <p class="no-data">Cargando archivos...</p>
            </div>
        </div>

        <!-- SECCIÓN 7: MANTENIMIENTO -->
        <div class="grid-2">
            <div class="card">
                <h2>
                    <i class="fas fa-wrench"></i>
                    Registro de Mantenimiento
                </h2>
                <form id="maintenanceForm">
                    <div class="form-group">
                        <label for="maintenanceType">Tipo de Intervención</label>
                        <input type="text" id="maintenanceType" placeholder="Ej: Cambio de aceite" required>
                    </div>
                    <div class="form-group">
                        <label for="maintenanceDate">Fecha</label>
                        <input type="date" id="maintenanceDate" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-plus-circle"></i>
                        Registrar Intervención
                    </button>
                </form>
            </div>

            <div class="card">
                <h2>
                    <i class="fas fa-history"></i>
                    Historial de Mantenimiento
                </h2>
                <ul id="maintenanceLog" style="list-style: none; margin: 0; padding: 0;">
                    <li class="no-data">No hay registros de mantenimiento</li>
                </ul>
            </div>
        </div>

    </div>

    <!-- FOOTER -->
    <footer>
        <p>SENTINEL PRO v9.0 - Sistema de Mantenimiento Predictivo © 2025</p>
        <p style="font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.7;">
            Optimizado: Datos críticos cada 3s | Datos térmicos cada 60s | Análisis predictivo con IA
        </p>
    </footer>

    <script src="js/common.js"></script>
    <script src="js/script.js"></script>
</body>
</html>